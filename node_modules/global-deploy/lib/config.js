const chalk = require('chalk');
const api = require('./api');
const _ = require('lodash');

const ROOT_URL = 'https://deploy.etranzactglobal.com';
const CONFIG_URL = `${ROOT_URL}/config`;

exports.Config = class Config {
  constructor(app_id, env) {
    this.app_id = app_id;
    this.env = env
  }

  async update_variables(variables) {
    const payload = {
      application: this.app_id,
      environment: this.env,
      variables: variables,
    }

    try {
      await api.post(CONFIG_URL, payload);
    } catch(e) {
      console.log(chalk`\n{red ERROR:} Unable to set application environment variables.`);
      throw Error(e.response.data.error);
    }
  }
}